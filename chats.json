{
    "1840233118": {
        "username": "ArtemKirss",
        "messages": [
            {
                "user_id": 1840233118,
                "username": "ArtemKirss",
                "message": "–æ–∂",
                "time_sent": "15:34; 11/02/2025"
            },
            {
                "username": "SupportBot",
                "message": "gd",
                "time_sent": "19:58; 14/02/2025"
            },
            {
                "username": "SupportBot",
                "message": "—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Å—é–¥–∞ –ø–∏—Å–∞—Ç—å –±—É–¥–µ—à –∫–∞–∂–¥—ã–π —Ä–∞–∑ –ø–∏—à–∏ /message —Ç–∞–∫ –∫–∞–∫ –±–æ—Ç –º–æ–∂–µ—Ç –Ω–µ —Å—Ä–∞–±–æ—Ç–∞—Ç—å –∏ –Ω–µ —Å—á–∏—Ç–∞—Ç—å —Å–æ–æ–±—à–µ–Ω–∏–µ",
                "time_sent": "11:55; 17/02/2025"
            },
            {
                "username": "SupportBot",
                "message": "–∏–º",
                "time_sent": "11:57; 17/02/2025"
            },
            {
                "username": "SupportBot",
                "message": "–ø–ø",
                "time_sent": "12:00; 17/02/2025"
            },
            {
                "username": "SupportBot",
                "message": "–ø–ø",
                "time_sent": "12:00; 17/02/2025"
            },
            {
                "username": "SupportBot",
                "message": "–ø–ø",
                "time_sent": "12:00; 17/02/2025"
            },
            {
                "username": "SupportBot",
                "message": "–ø–ø",
                "time_sent": "12:00; 17/02/2025"
            },
            {
                "username": "ArtemKirss",
                "message": "–ø",
                "time_sent": "12:01; 17/02/2025"
            },
            {
                "username": "ArtemKirss",
                "message": "–ø",
                "time_sent": "12:01; 17/02/2025"
            },
            {
                "username": "ArtemKirss",
                "message": "–ø",
                "time_sent": "12:01; 17/02/2025"
            },
            {
                "username": "ArtemKirss",
                "message": "–ø",
                "time_sent": "12:01; 17/02/2025"
            },
            {
                "username": "ArtemKirss",
                "message": "–ø",
                "time_sent": "12:01; 17/02/2025"
            },
            {
                "username": "ArtemKirss",
                "message": "–ø",
                "time_sent": "12:01; 17/02/2025"
            },
            {
                "username": "SupportBot",
                "message": "—Ç",
                "time_sent": "12:16; 17/02/2025"
            },
            {
                "username": "SupportBot",
                "message": "–æ",
                "time_sent": "12:16; 17/02/2025"
            },
            {
                "username": "SupportBot",
                "message": "–æ",
                "time_sent": "12:16; 17/02/2025"
            },
            {
                "username": "ArtemKirss",
                "message": "–æ",
                "time_sent": "12:18; 17/02/2025"
            },
            {
                "username": "ArtemKirss",
                "message": "–ø",
                "time_sent": "12:18; 17/02/2025"
            },
            {
                "username": "ArtemKirss",
                "message": "—ã",
                "time_sent": "12:18; 17/02/2025"
            },
            {
                "username": "ArtemKirss",
                "message": "–æ–æ",
                "time_sent": "12:18; 17/02/2025"
            },
            {
                "username": "ArtemKirss",
                "message": "–æ",
                "time_sent": "12:18; 17/02/2025"
            },
            {
                "username": "ArtemKirss",
                "message": "–æ",
                "time_sent": "12:18; 17/02/2025"
            },
            {
                "username": "ArtemKirss",
                "message": "–∞",
                "time_sent": "12:18; 17/02/2025"
            },
            {
                "username": "ArtemKirss",
                "message": "—ã",
                "time_sent": "12:18; 17/02/2025"
            },
            {
                "username": "SupportBot",
                "message": "–∏–∏",
                "time_sent": "13:35; 17/02/2025"
            },
            {
                "username": "ArtemKirss",
                "message": "–æ",
                "time_sent": "13:40; 17/02/2025"
            },
            {
                "username": "ArtemKirss",
                "message": "—Ä–∫",
                "time_sent": "17:28; 17/02/2025"
            },
            {
                "username": "ArtemKirss",
                "message": "let unreadMessages = {}; // –•—Ä–∞–Ω–∏—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è\n\nfunction openChat(userId, secondName, username) {\n    console.log(\"–ß–∞—Ç —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º \" + secondName + \" –æ—Ç–∫—Ä—ã—Ç.\");\n\n    fetch('/open_chat', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ user_id: userId })\n    });\n\n    const chatContainer = document.getElementById('chat-container');\n    chatContainer.classList.add('open');\n    document.getElementById('chat-username').innerText = username; // –§–∏–∫—Å: username —Ç–µ–ø–µ—Ä—å –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –º–µ—Å—Ç–µ\n    document.getElementById('chat-name').innerText = secondName; // –§–∏–∫—Å: secondName –≤ —Å–≤–æ–µ–º –ø–æ–ª–µ\n    document.getElementById('chat-id').innerText = userId;\n\n    function parseDate(dateString) {\n        const parts = dateString.split('; ');\n        if (parts.length !== 2) return new Date();\n        const [time, date] = parts;\n        const [day, month, year] = date.split('/');\n        return new Date(${year}-${month}-${day}T${time}:00);\n    }\n\n    function loadMessages() {\n        getChatMessages(userId).then(messages => {\n            const chatMessagesContainer = document.getElementById('chat-messages');\n            const isAtBottom = chatMessagesContainer.scrollHeight - chatMessagesContainer.scrollTop <= chatMessagesContainer.clientHeight + 10;\n            chatMessagesContainer.innerHTML = '';\n\n            let lastDate = '';\n\n            messages.forEach(message => {\n                const messageDate = parseDate(message.time_sent);\n                const formattedDate = messageDate.toLocaleDateString('ru-RU', { year: 'numeric', month: 'long', day: 'numeric' });\n                const formattedTime = messageDate.toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' });\n\n                // –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ –¥–∞—Ç–∞–º\n                if (formattedDate !== lastDate) {\n                    const dateElement = document.createElement('div');\n                    dateElement.classList.add('date-separator');\n                    dateElement.innerText = formattedDate;\n                    chatMessagesContainer.appendChild(dateElement);\n                    lastDate = formattedDate;\n                }\n\n                const messageElement = document.createElement('div');\n                messageElement.classList.add('message');\n\n                if (message.username === \"SupportBot\") {\n                    messageElement.classList.add('support');\n                }\n\n                messageElement.innerHTML = `\n                    <strong>${message.username}</strong>: ${message.message}\n                    <div class=\"timestamp\">${formattedTime}</div>\n                `;\n                chatMessagesContainer.appendChild(messageElement);\n            });\n\n            if (isAtBottom) {\n                chatMessagesContainer.scrollTop = chatMessagesContainer.scrollHeight;\n            }\n        });\n    }\n\n    loadMessages();\n\n    if (chatUpdateInterval) clearInterval(chatUpdateInterval);\n    chatUpdateInterval = setInterval(loadMessages, 1000);\n\n    unreadMessages[userId] = 0;\n    updateUnreadCount(userId);\n}\n\n// üìå –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π\nfunction updateUnreadCount(userId, newMessages = 0) {\n    if (newMessages > 0) {\n        unreadMessages[userId] = (unreadMessages[userId] || 0) + newMessages;\n    } else {\n        unreadMessages[userId] = 0;\n    }\n\n    const userElement = document.getElementById(user-${userId});\n    if (userElement) {\n        const badge = userElement.querySelector('.unread-badge');\n        if (unreadMessages[userId] > 0) {\n            badge.innerText = unreadMessages[userId];\n            badge.style.display = 'block';\n        } else {\n            badge.style.display = 'none';\n        }\n    }\n}",
                "time_sent": "17:28; 17/02/2025"
            },
            {
                "username": "ArtemKirss",
                "message": "// üìå –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π –≤ HTML\ndocument.querySelectorAll('.user-item').forEach(userElement => {\n    if (!userElement.querySelector('.unread-badge')) {\n        const badge = document.createElement('div');\n        badge.classList.add('unread-badge');\n        badge.style.display = 'none';\n        userElement.appendChild(badge);\n    }\n});",
                "time_sent": "17:29; 17/02/2025"
            },
            {
                "username": "ArtemKirss",
                "message": "let unreadMessages = {}; // –•—Ä–∞–Ω–∏—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è\n\nfunction openChat(userId, secondName, username) {\n    console.log(\"–ß–∞—Ç —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º \" + secondName + \" –æ—Ç–∫—Ä—ã—Ç.\");\n\n    fetch('/open_chat', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ user_id: userId })\n    });\n\n    const chatContainer = document.getElementById('chat-container');\n    chatContainer.classList.add('open');\n    document.getElementById('chat-username').innerText = username; // –§–∏–∫—Å: username —Ç–µ–ø–µ—Ä—å –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –º–µ—Å—Ç–µ\n    document.getElementById('chat-name').innerText = secondName; // –§–∏–∫—Å: secondName –≤ —Å–≤–æ–µ–º –ø–æ–ª–µ\n    document.getElementById('chat-id').innerText = userId;\n\n    function parseDate(dateString) {\n        const parts = dateString.split('; ');\n        if (parts.length !== 2) return new Date();\n        const [time, date] = parts;\n        const [day, month, year] = date.split('/');\n        return new Date(${year}-${month}-${day}T${time}:00);\n    }\n\n    function loadMessages() {\n        getChatMessages(userId).then(messages => {\n            const chatMessagesContainer = document.getElementById('chat-messages');\n            const isAtBottom = chatMessagesContainer.scrollHeight - chatMessagesContainer.scrollTop <= chatMessagesContainer.clientHeight + 10;\n            chatMessagesContainer.innerHTML = '';\n\n            let lastDate = '';\n\n            messages.forEach(message => {\n                const messageDate = parseDate(message.time_sent);\n                const formattedDate = messageDate.toLocaleDateString('ru-RU', { year: 'numeric', month: 'long', day: 'numeric' });\n                const formattedTime = messageDate.toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' });\n\n                // –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ –¥–∞—Ç–∞–º\n                if (formattedDate !== lastDate) {\n                    const dateElement = document.createElement('div');\n                    dateElement.classList.add('date-separator');\n                    dateElement.innerText = formattedDate;\n                    chatMessagesContainer.appendChild(dateElement);\n                    lastDate = formattedDate;\n                }\n\n                const messageElement = document.createElement('div');\n                messageElement.classList.add('message');\n\n                if (message.username === \"SupportBot\") {\n                    messageElement.classList.add('support');\n                }\n\n                messageElement.innerHTML = `\n                    <strong>${message.username}</strong>: ${message.message}\n                    <div class=\"timestamp\">${formattedTime}</div>\n                `;\n                chatMessagesContainer.appendChild(messageElement);\n            });\n\n            if (isAtBottom) {\n                chatMessagesContainer.scrollTop = chatMessagesContainer.scrollHeight;\n            }\n        });\n    }\n\n    loadMessages();\n\n    if (chatUpdateInterval) clearInterval(chatUpdateInterval);\n    chatUpdateInterval = setInterval(loadMessages, 1000);\n\n    unreadMessages[userId] = 0;\n    updateUnreadCount(userId);\n}\n\n// üìå –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π\nfunction updateUnreadCount(userId, newMessages = 0) {\n    if (newMessages > 0) {\n        unreadMessages[userId] = (unreadMessages[userId] || 0) + newMessages;\n    } else {\n        unreadMessages[userId] = 0;\n    }\n\n    const userElement = document.getElementById(user-${userId});\n    if (userElement) {\n        const badge = userElement.querySelector('.unread-badge');\n        if (unreadMessages[userId] > 0) {\n            badge.innerText = unreadMessages[userId];\n            badge.style.display = 'block';\n        } else {\n            badge.style.display = 'none';\n        }\n    }\n}",
                "time_sent": "17:29; 17/02/2025"
            },
            {
                "username": "ArtemKirss",
                "message": "// üìå –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π –≤ HTML\ndocument.querySelectorAll('.user-item').forEach(userElement => {\n    if (!userElement.querySelector('.unread-badge')) {\n        const badge = document.createElement('div');\n        badge.classList.add('unread-badge');\n        badge.style.display = 'none';\n        userElement.appendChild(badge);\n    }\n});",
                "time_sent": "17:29; 17/02/2025"
            },
            {
                "username": "SupportBot",
                "message": "—Ä–ø",
                "time_sent": "17:31; 17/02/2025"
            },
            {
                "username": "ArtemKirss",
                "message": "–æ",
                "time_sent": "17:31; 17/02/2025"
            },
            {
                "username": "ArtemKirss",
                "message": "–æ",
                "time_sent": "17:31; 17/02/2025"
            },
            {
                "username": "ArtemKirss",
                "message": "–æ",
                "time_sent": "17:31; 17/02/2025"
            },
            {
                "username": "ArtemKirss",
                "message": "–ª",
                "time_sent": "18:57; 17/02/2025"
            },
            {
                "username": "ArtemKirss",
                "message": "–ª",
                "time_sent": "18:57; 17/02/2025"
            },
            {
                "username": "ArtemKirss",
                "message": "–¥",
                "time_sent": "18:57; 17/02/2025"
            },
            {
                "username": "ArtemKirss",
                "message": "–¥",
                "time_sent": "18:58; 17/02/2025"
            },
            {
                "username": "ArtemKirss",
                "message": "–µ",
                "time_sent": "18:58; 17/02/2025"
            }
        ]
    },
    "1013802830": {
        "username": "RavaNay",
        "messages": [
            {
                "username": "RavaNay",
                "message": "–æ–∞–æ–∞–æ–∞",
                "time_sent": "19:02; 13/02/2025"
            },
            {
                "username": "SupportBot",
                "message": "–ü—Ä–∏–≤–µ—Ç",
                "time_sent": "20:08; 14/02/2025"
            },
            {
                "username": "RavaNay",
                "message": "–î–∞—Ä–æ—É–∞",
                "time_sent": "20:08; 14/02/2025"
            },
            {
                "username": "SupportBot",
                "message": "–¢–µ–±–µ –ø—Ä–∏—à–ª–æ —Å–æ–æ–±—à–µ–Ω–∏–µ?",
                "time_sent": "20:08; 14/02/2025"
            },
            {
                "username": "RavaNay",
                "message": "–¥–∞",
                "time_sent": "20:08; 14/02/2025"
            },
            {
                "username": "SupportBot",
                "message": "–û–û–û–û",
                "time_sent": "20:08; 14/02/2025"
            },
            {
                "username": "RavaNay",
                "message": "–ö—Ä–∞—Å–∞–≤—á–∏–∫)",
                "time_sent": "20:08; 14/02/2025"
            },
            {
                "username": "SupportBot",
                "message": "—è –ø–∏—à—É —Å —Å–∞–π—Ç–∞ –Ω–æ —Ç—É—Ç –ø—Ä–æ–±–ª–µ–º–∞ –≤ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã",
                "time_sent": "20:09; 14/02/2025"
            },
            {
                "username": "SupportBot",
                "message": "—Ö–æ—à —Ñ–æ—Ç–æ —Å–∫–∏–Ω—É?",
                "time_sent": "20:09; 14/02/2025"
            },
            {
                "username": "RavaNay",
                "message": "–¥–∞–≤–∞–π",
                "time_sent": "20:09; 14/02/2025"
            }
        ]
    },
    "6222116355": {
        "username": "–ù–µ –≤–∫–∞–∑–∞–Ω–æ",
        "messages": [
            {
                "username": "–Ω–µ–º–∞—î —ñ–º–µ–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞",
                "message": "–ê",
                "time_sent": "11:23; 17/02/2025"
            },
            {
                "username": "–Ω–µ–º–∞—î —ñ–º–µ–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞",
                "message": "–ë",
                "time_sent": "11:23; 17/02/2025"
            },
            {
                "username": "SupportBot",
                "message": "–∫—Å—Ç–∞ –ø—Ä–∏–≤–µ—Ç",
                "time_sent": "11:48; 17/02/2025"
            },
            {
                "username": "SupportBot",
                "message": "—è —Å–µ–π—á–∞—Å —Å —Å–∞–π—Ç–∞ –ø–∏—à—É",
                "time_sent": "11:49; 17/02/2025"
            },
            {
                "username": "SupportBot",
                "message": "–ø—Ä–∞–≤–¥–∞ –±–æ—Ç –Ω–µ 24/7 —Ä–∞–±–æ—Ç–∞–µ—Ç",
                "time_sent": "11:50; 17/02/2025"
            },
            {
                "username": "SupportBot",
                "message": "—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Å—é–¥–∞ –ø–∏—Å–∞—Ç—å –±—É–¥–µ—à –∫–∞–∂–¥—ã–π —Ä–∞–∑ –ø–∏—à–∏ /message —Ç–∞–∫ –∫–∞–∫ –±–æ—Ç –º–æ–∂–µ—Ç –Ω–µ —Å—Ä–∞–±–æ—Ç–∞—Ç—å –∏ –Ω–µ —Å—á–∏—Ç–∞—Ç—å —Å–æ–æ–±—à–µ–Ω–∏–µ",
                "time_sent": "11:54; 17/02/2025"
            }
        ]
    }
}